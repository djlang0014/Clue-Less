<!-- templates/main_menu.html -->
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="static/gameplaytest.css">
    <!-- Link to the socket.io info -->
    <script type="text/javascript" src="//code.jquery.com/jquery-1.4.2.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.0/socket.io.js"></script>

    <script>
        var socket;            
        $(document).ready(function() {
            // The http vs. https is important. Use http for localhost!
            socket = io.connect('http://' + document.domain + ':' + location.port);
            
            document.getElementById("submittest").onclick = function(){
                // Get the text value
                var text = document.getElementById("testo").value;

                // Emit a message to the 'send_message' socket
                socket.emit('message', {'text':text});

                // Set the textfield input to empty
                document.getElementById("testo").value = "";
            }

            document.getElementById("getinfo").onclick = function(){
                socket.emit('request_player_info');
            }

            // Message recieved from server
            socket.on('message_from_server', function(data) {
                var text = data['text'];
                document.getElementById("chat").innerHTML += "Server: " + text + "\n\n";   
            });

            socket.on('playerinfo', function(data) {
                console.log(data);
                playername = data['playername'];
                playercharacter = data['playercharacter'];
                document.getElementById('playerinfooutput').innerText = "Player Name: " + playername + "\nPlayer Character: " + playercharacter;
            });

            socket.on('playercard', function(data){
                var outputlist = document.getElementById("cardoutput");
                outputlist.innerHTML = '';

                data.forEach(function(item){
                    var li = document.createElement("li");
                    li.textContent = item;
                    outputlist.appendChild(li);
                });

            });


        });

    </script>

    <style>

        .radio-list-accuse{
            position: relative;
            left: 52.5vw;
            width: 45vw;
            height: 90vh;
            display: none;
            grid-template-columns: 15vw 15vw 15vw;
            grid-template-rows: 15vh 15vh 15vh 15vh 15vh 15vh 15vh 15vh 15vh;
        }

        .radio-list-move{
            position: fixed;
            left: 52.5vw;
            width: 15vw;
            height: 90vh;
            display: none;
            grid-template-columns: 15vw;
            grid-template-rows: 15vh 15vh 15vh 15vh 15vh 15vh 15vh 15vh 15vh;

        }
        .radio-list-suggest{
            position: fixed;
            left: 52.5vw;
            width: 30vw;
            height: 90vh;
            display: none;
            grid-template-columns: 15vw 15vw;
            grid-template-rows: 15vh 15vh 15vh 15vh 15vh 15vh 15vh 15vh 15vh;

        }
        .endTurnContainer{
            position: fixed;
            left:52.5vw;
            width:30vw;
            height: 90vh;
            display: none;
        }
        .output {
            margin: 0;
            padding: 0;
            display: none;
        }

    </style>
    
</head>
<body>
    <div class ="leftcol"> 

    </div>
    <div class ="wrapper">
        <div class="green" id="MrGreen" style="top: 680px; left: 330px;"></div>
        <div class="red"  style="top: 180px; left: 590px;"></div>
        <div class="blue"  style="top: 550px; left: 170px;"></div>
        <div class="purple"  style="top: 310px; left: 170px;"></div>
        <div class="white"  style="top: 680px; left: 590px;"></div>
        <div class="yellow"  style="top: 310px; left: 750px;"></div>
    </div>
    <div class ="rightcol"> 
        
    </div>


    <div class = "characterinfo">
        <input id = "getinfo" type = "button">Load</input>
        <p>Player Info: </p>
        <div id = "playerinfooutput"></div>
        <ul id = "cardoutput"></ul>
    </div>

    <div class = "movebutton">
        <!--This will have to be changed to selecting the location to move to-->
        <button onclick = "showMoveList()">Move</button>
    </div>

    <div class = "suggestbutton">
        <button onclick = "showSuggestList()">Suggest</button>
    </div>

    <div class = "accusebutton">
        <button onclick = "showAccuseList()">Accuse</button>
    </div>

    <div class = "endbutton">
        <button onclick = "showEndTurn()">End Turn</button>
    </div>

    <div id = "serverchat" class = "serverchat">
        <textarea id="chat" style="width: 450px; height: 750px; font-size: 18px; font-family: monospace; margin-top: 10px;"></textarea>
    </div>

    <div id = "accuseRadio" class = "radio-list-accuse">
        <form method = "post" action = "/accusesubmit" target = "hidden-iframe">
            <h3>Weapon</h3>
            <label>
                <input type="radio" name="Weapon" value="Candlestick"> Candlestick
                <input type="radio" name="Weapon" value="Knife"> Knife
                <input type="radio" name="Weapon" value="Revolver"> Revolver
                <input type="radio" name="Weapon" value="Lead Pipe"> Lead Pipe
                <input type="radio" name="Weapon" value="Wrench"> Wrench
                <input type="radio" name="Weapon" value="Rope"> Rope
            </label>
            <h3>Character</h3>
            <label>
                <input type="radio" name="Character" value="Miss Scarlet"> Miss Scarlet
                <input type="radio" name="Character" value="Mrs. Peacock"> Mrs. Peacock 
                <input type="radio" name="Character" value="Mrs. White"> Mrs. White 
                <input type="radio" name="Character" value="Col Mustard"> Col. Mustard 
                <input type="radio" name="Character" value="Mr. Green"> Mr. Green
                <input type="radio" name="Character" value="Prof Plum"> Prof Plum 
                <input type="radio" name="Character" value="Dr. Orchid"> Dr. Orchid 
                <input type="radio" name="Character" value="Miss Peach"> Miss Peach 
            </label>
            <h3>Location</h3>
            <label>
                <input type="radio" name="Location" value="Kitchen"> Kitchen
                <input type="radio" name="Location" value="Study"> Study
                <input type="radio" name="Location" value="Billiard Room"> Billiard Room
                <input type="radio" name="Location" value="Lounge"> Lounge
                <input type="radio" name="Location" value="Library"> Library
                <input type="radio" name="Location" value="Conservatory"> Conservatory
                <input type="radio" name="Location" value="Hall"> Hall
                <input type="radio" name="Location" value="Ballroom"> Ballroom
                <input type="radio" name="Location" value="Dining Room"> Dining Room
            </label>
            <input type = "submit" value = "Submit">
        </form>
    </div>

    <div id = "moveRadio" class = "radio-list-move">
        <form method = "post" action = "/movesubmit" target = "hidden-iframe" id = "positionForm">
            <h3>Location</h3>
            <label>
                <input type="radio" name="Location" value="Kitchen"> Kitchen
                <input type="radio" name="Location" value="Study"> Study
                <input type="radio" name="Location" value="Billiard"> Billiard Room
                <input type="radio" name="Location" value="Lounge"> Lounge
                <input type="radio" name="Location" value="Library"> Library
                <input type="radio" name="Location" value="Conservatory"> Conservatory
                <input type="radio" name="Location" value="Hall"> Hall
                <input type="radio" name="Location" value="Ballroom"> Ballroom
                <input type="radio" name="Location" value="Dining"> Dining Room
            </label>
            <input type = "submit" value = "Submit">
        </form>
    </div>
    
    <div id = "suggestRadio" class = "radio-list-suggest">
        <form method = "post" action = "/suggestsubmit" target = "hidden-iframe">
            <h3>Weapon</h3>
            <label>
                <input type="radio" name="Weapon" value="Candlestick"> Candlestick
                <input type="radio" name="Weapon" value="Knife"> Knife
                <input type="radio" name="Weapon" value="Revolver"> Revolver
                <input type="radio" name="Weapon" value="Lead Pipe"> Lead Pipe
                <input type="radio" name="Weapon" value="Wrench"> Wrench
                <input type="radio" name="Weapon" value="Rope"> Rope
            </label>
            <h3>Character</h3>
            <label>
                <input type="radio" name="Character" value="Miss Scarlet"> Miss Scarlet
                <input type="radio" name="Character" value="Mrs. Peacock"> Mrs. Peacock 
                <input type="radio" name="Character" value="Mrs. White"> Mrs. White 
                <input type="radio" name="Character" value="Col Mustard"> Col. Mustard 
                <input type="radio" name="Character" value="Mr. Green"> Mr. Green
                <input type="radio" name="Character" value="Prof Plum"> Prof Plum 
                <input type="radio" name="Character" value="Dr. Orchid"> Dr. Orchid 
                <input type="radio" name="Character" value="Miss Peach"> Miss Peach 
            </label>
            <input type = "submit" value = "Submit">
        </form>
    </div>

    <div id = "endTurnContainer" class = "endTurnContainer">
        <form method = "post" action = "/endturnsubmit" target = "hidden-iframe">
            <h1>Are you sure?</h1>
            <input type = "submit" value = "End Turn">
        </form>
    
    <div class = "output">
        <p id='output'></p>
    </div>
    


    <script>
        var movingImage = document.getElementById('MrGreen');
        var positionForm = document.getElementById('positionForm');
        var moveContainer = document.getElementById('moveRadio');
        var suggestContainer = document.getElementById('suggestRadio');
        var accuseContainer = document.getElementById('accuseRadio');
        var endTurnContainer = document.getElementById('endTurnContainer');

        document.onmousemove=getCursorPos;
        var output = document.getElementById('output');
        function getCursorPos(a)
        {
        var posx = a.clientX;
        var posy = a.clientY;
        output.innerHTML="Position X: " + posx + "px & Position Y: " + posy + "px";
        } 

        var locations = {
            study: {top:235 , left: 225},
            Hall1: {top:215, left: 350},
            Hall: {top:215, left: 470},
            Hall2: {top:215, left: 610},
            Lounge: {top:215, left: 730},
            Hall3: {top:315, left: 225},
            Hall4: {top:315, left: 470},
            Hall5: {top:315, left: 730},
            Library: {top:415, left: 225},
            Hall6: {top:415, left:350},
            Billiard: {top:415, left:470},
            Hall7: {top:415, left:610},
            Dining: {top:415, left:730},
            Hall8: {top:540, left: 225},
            Hall9: {top:540, left: 470},
            Hall10: {top:540, left: 730},
            Conservatory: {top:640, left: 225},
            Hall11: {top:640, left: 350},
            Ballroom: {top:640, left: 470},
            Hall12: {top:640, left: 610},
            Kitchen: {top:640, left: 730}
        }

        function moveImage() {
            var selectedPosition = document.querySelector('input[name="Location"]:checked').value;
            var newPosition = locations[selectedPosition];

            movingImage.style.top = newPosition.top + "px";
            movingImage.style.left = newPosition.left + "px";
        }

        positionForm.addEventListener('submit', function(event) {
            event.preventDefault();
            moveImage();
            positionForm.submit();
        });

        function showAccuseList(){
            moveContainer.style.display = "none";
            suggestContainer.style.display = "none";
            endTurnContainer.style.display = "none";

            if(accuseContainer.style.display === "none")
            {
                accuseContainer.style.display = "grid";
            }
            else
            {
                accuseContainer.style.display = "none";
            }
        }

        function showSuggestList(){
            moveContainer.style.display = "none";
            accuseContainer.style.display = "none";
            endTurnContainer.style.display = "none";

            if(suggestContainer.style.display === "none")
            {
                suggestContainer.style.display = "grid";
            }
            else
            {
                suggestContainer.style.display = "none";
            }
        }

        function showMoveList(){
            suggestContainer.style.display = "none";
            accuseContainer.style.display = "none";
            endTurnContainer.style.display = "none";

            if(moveContainer.style.display === "none")
            {
                moveContainer.style.display = "grid";
            }
            else
            {
                moveContainer.style.display = "none";
            }
        }

        function showEndTurn(){
            suggestContainer.style.display = "none";
            accuseContainer.style.display = "none";
            moveContainer.style.display = "none";

            if(endTurnContainer.style.display === "none")
            {
                endTurnContainer.style.display = "grid";
            }
            else
            {
                endTurnContainer.style.display = "none";
            }

        }

        function updateLocationsAndRadioButtons(){
            fetch('/getlocations')
        }



    </script>

    <iframe name = "hidden-iframe" style = "display:none"></iframe>
</body>
</html>